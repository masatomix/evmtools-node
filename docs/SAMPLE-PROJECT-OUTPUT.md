# EVM指標サンプル出力

3つのプロジェクトを比較して、EVM指標の意味を理解する。

## 共通設定

- **タスク数**: 5タスク（各1人日）
- **期間**: 5稼働日（2025-08-01 〜 2025-08-07）
- **基準日**: 3日目（2025-08-05、中間地点）
- **日々のPV**: 1.0人日（理想的な状態）

---

## ケース比較

```
        PV/EV
          ^
        5 │                              ────────────── BAC
          │                         ╱
        4 │                    ╱
          │               ╱
        3 │- - - - - ╱- - - - - - - - - - - - - - - - PV（3日目）
          │     ╱    ┃
        2 │╱         ┃  ● 順調: EV=3 (SPI=1.0)
          │          ┃  ◆ 失速: EV=2.2 (SPI=0.73)
        1 │          ┃  ▲ 遅延: EV=1.5 (SPI=0.5)
          │          ┃
        0 └──────────┃──────────────────────────────→ 日
          1    2    3    4    5    6    7    8    ...
                    ↑
                 基準日
```

---

## ケース1: 順調プロジェクト

### 設定

| タスク | 予定日 | 進捗率 | 状態 |
|-------|--------|--------|------|
| タスク1 | 8/1 | 100% | 完了 |
| タスク2 | 8/4 | 100% | 完了 |
| タスク3 | 8/5 | 100% | 完了（基準日） |
| タスク4 | 8/6 | 0% | 未着手 |
| タスク5 | 8/7 | 0% | 未着手 |

### 計算

| 指標 | 値 | 説明 |
|-----|-----|------|
| BAC | 5人日 | 総予定工数 |
| PV | 3人日 | 3日目までの計画 |
| EV | 3人日 | 3タスク完了 |
| SPI | 1.0 | EV / PV = 3 / 3 |
| ETC' | 2人日 | (BAC - EV) / SPI = (5 - 3) / 1.0 |

### 結果

| 項目 | 値 |
|-----|-----|
| 終了予定日 | 2025-08-07 |
| **完了予測日** | **2025-08-07** |
| 遅延日数 | 0日 |

→ **予定通り完了する見込み**

---

## ケース2: 遅延プロジェクト

### 設定

| タスク | 予定日 | 進捗率 | 状態 |
|-------|--------|--------|------|
| タスク1 | 8/1 | 100% | 完了 |
| タスク2 | 8/4 | 50% | 遅れ |
| タスク3 | 8/5 | 0% | 未着手（基準日なのに！） |
| タスク4 | 8/6 | 0% | 未着手 |
| タスク5 | 8/7 | 0% | 未着手 |

### 計算

| 指標 | 値 | 説明 |
|-----|-----|------|
| BAC | 5人日 | 総予定工数 |
| PV | 3人日 | 3日目までの計画 |
| EV | 1.5人日 | 1 + 0.5 + 0 |
| SPI | **0.5** | 生産性が半分 |
| ETC' | 7人日 | (5 - 1.5) / 0.5 |

### 結果

| 項目 | 値 |
|-----|-----|
| 終了予定日 | 2025-08-07 |
| **完了予測日** | **2025-08-14** |
| 遅延日数 | **7日** |

→ **1週間遅れる見込み**

---

## ケース3: 失速プロジェクト

### 設定

| タスク | 予定日 | 進捗率 | 状態 |
|-------|--------|--------|------|
| タスク1 | 8/1 | 100% | 完了（順調だった） |
| タスク2 | 8/4 | 100% | 完了（まだ順調） |
| タスク3 | 8/5 | **20%** | 急に失速！ |
| タスク4 | 8/6 | 0% | 未着手 |
| タスク5 | 8/7 | 0% | 未着手 |

### 計算

| 指標 | 値 | 説明 |
|-----|-----|------|
| BAC | 5人日 | 総予定工数 |
| PV | 3人日 | 3日目までの計画 |
| EV | 2.2人日 | 1 + 1 + 0.2 |
| SPI（累積） | **0.733** | 中程度の遅れに見える |
| SPI（直近1日） | **0.2** | 実は深刻！ |
| ETC' | 3.82人日 | (5 - 2.2) / 0.733 |

### 結果

| 項目 | 値 |
|-----|-----|
| 終了予定日 | 2025-08-07 |
| **完了予測日** | **2025-08-11** |
| 遅延日数 | **4日** |

→ **4日遅れる見込み（ただし累積SPIベース）**

> **注意**: 上記は累積SPI（0.733）を使った予測。しかし基準日（タスク3）のSPIは**0.2**と非常に悪い。
> もし直近SPIを使って計算すると:
> - ETC' = (5 - 2.2) / 0.2 = **14人日**
> - 完了予測日 = 2025-08-05 + 14稼働日 = **2025-08-25**
> - 遅延日数 = **18日**（累積SPI版の4.5倍！）
>
> **現状この「直近SPI版」の完了予測は未実装** → [#139](https://github.com/masatomix/evmtools-node/issues/139), [#140](https://github.com/masatomix/evmtools-node/issues/140)

---

## サマリ比較

```
完了予測日のタイムライン:

8/7 (終了予定日)    8/11              8/14
    ↓                ↓                 ↓
────●────────────────◆─────────────────▲────→
    │                │                 │
    順調             失速              遅延
    (SPI=1.0)       (SPI=0.73)        (SPI=0.5)
```

| プロジェクト | BAC | PV | EV | SPI | 完了予測日 | 遅延日数 |
|-------------|-----|-----|-----|-----|-----------|---------|
| 順調 | 5人日 | 3人日 | 3人日 | 1.0 | 2025-08-07 | 0日 |
| 失速 | 5人日 | 3人日 | 2.2人日 | 0.733 | 2025-08-11 | **4日** ※1 |
| 遅延 | 5人日 | 3人日 | 1.5人日 | 0.5 | 2025-08-14 | 7日 |

> ※1 累積SPIベースの予測。直近SPIで計算すると**18日**遅延。詳細は「累積SPIの落とし穴」参照。

---

## 重要な気づき

### 累積SPIの落とし穴

失速プロジェクトの**累積SPI（0.733）**は遅延プロジェクト（0.5）より良く見える。

しかし、**直近の状況**を見ると:

| プロジェクト | 累積SPI | 直近1日のSPI | 実態 |
|-------------|---------|-------------|------|
| 順調 | 1.0 | 1.0 | 問題なし |
| 失速 | 0.733 | **0.2** | 深刻な問題！ |
| 遅延 | 0.5 | 0.5 | 継続的な遅れ |

**失速プロジェクトを直近SPIで再計算すると:**

| 指標 | 累積SPI版 | 直近SPI版 |
|-----|----------|----------|
| 使用SPI | 0.733 | **0.2** |
| ETC' | (5-2.2)/0.733 = 3.82人日 | (5-2.2)/0.2 = **14人日** |
| 完了予測日 | 2025-08-11 | 2025-08-05 + 14日 = **2025-08-25** |
| 遅延日数 | 4日 | **18日**（4.5倍！） |

### 結論

- **累積SPI**だけでは「失速」を見逃す可能性がある
- **直近N日のSPI**を使えば、失速を早期に検知できる
- → [#139 直近N日のSPI計算機能](https://github.com/masatomix/evmtools-node/issues/139) の実装が重要

---

## 付録: 実際の出力例（now.xlsm）

以下は `npm run pbevm-show-project` の実行結果。

### TaskRow一覧

| # | id | name | assignee | workload | progressRate | pv | ev | spi | 予定開始日 | 予定終了日 |
|---|-----|------|----------|----------|--------------|-----|-----|-----|-----------|-----------|
| 1 | 1 | 要件定義 | - | 4 | 1 | 4 | 4 | 1 | 2025/07/01 | 2025/07/04 |
| 2 | 2 | 機能全体 | 要員A | 4 | 1 | 4 | 4 | 1 | 2025/07/01 | 2025/07/04 |
| 3 | 3 | 設計 | - | 15 | 1 | 15 | 15 | 1 | 2025/07/07 | 2025/07/18 |
| 4 | 4 | 機能1 | 要員A | 3 | 1 | 3 | 3 | 1 | 2025/07/07 | 2025/07/11 |
| 5 | 5 | 機能2 | 要員A | 2 | 1 | 2 | 2 | 1 | 2025/07/07 | 2025/07/11 |
| 6 | 6 | 機能3 | 要員B | 5 | 1 | 5 | 5 | 1 | 2025/07/14 | 2025/07/18 |
| 7 | 7 | 機能4 | 要員A | 5 | 1 | 5 | 5 | 1 | 2025/07/14 | 2025/07/18 |
| 8 | 8 | 開発 | - | 30 | 0.25 | 15 | 7.5 | **0.5** | 2025/07/21 | 2025/08/01 |
| 9 | 9 | 機能1 | 要員A | 10 | 0.1 | 5 | 1 | **0.2** | 2025/07/21 | 2025/08/01 |
| 10 | 10 | 機能2 | 要員B | 5 | 0.2 | 2.5 | 1 | **0.4** | 2025/07/21 | 2025/08/01 |
| 11 | 11 | 機能3 | 要員B | 5 | 0.3 | 2.5 | 1.5 | **0.6** | 2025/07/21 | 2025/08/01 |
| 12 | 12 | 機能4 | 要員C | 10 | 0.4 | 5 | 4 | **0.8** | 2025/07/21 | 2025/08/01 |
| 13 | 13 | テスト | - | 15 | 0 | 0 | 0 | 0 | 2025/08/04 | 2025/08/22 |
| 14 | 14 | 単体テスト | 要員A | 5 | - | 0 | 0 | 0 | 2025/08/04 | 2025/08/08 |
| 15 | 15 | 連結テスト | 要員A | 5 | - | 0 | 0 | 0 | 2025/08/11 | 2025/08/15 |
| 16 | 16 | 総合テスト | 要員A | 5 | - | 0 | 0 | 0 | 2025/08/18 | 2025/08/22 |
| 17 | 17 | リリース | - | 2 | 0 | 0 | 0 | 0 | 2025/08/25 | 2025/08/26 |
| 18 | 18 | 準備 | 要員C | 1 | - | 0 | 0 | 0 | 2025/08/25 | 2025/08/25 |
| 19 | 19 | 作業 | 要員C | 1 | - | 0 | 0 | 0 | 2025/08/26 | 2025/08/26 |

### ProjectStatistics

| 項目 | 値 |
|-----|-----|
| projectName | now |
| startDate | 2025/07/01 |
| endDate | 2025/08/26 |
| totalTasksCount | 14 |
| totalWorkloadExcel (BAC) | 66人日 |
| baseDate | 2025/07/25 |
| totalPvCalculated | 34人日 |
| totalEv | 26.5人日 |
| **spi** | **0.779** |
| **etcPrime** | **50.68人日** |
| **completionForecast** | **2025-10-06** |
| delayedTaskCount | 0 |
| averageDelayDays | 0 |
| maxDelayDays | 0 |

### AssigneeStatistics

| assignee | tasks | BAC | PV | EV | SPI | etcPrime | completionForecast |
|----------|-------|-----|-----|-----|-----|----------|-------------------|
| 要員A | 8 | 39人日 | 19人日 | 15人日 | 0.789 | 30.4人日 | 2025-09-08 |
| 要員B | 3 | 15人日 | 10人日 | 7.5人日 | 0.75 | 10人日 | 2025-08-08 |
| 要員C | 3 | 12人日 | 5人日 | 4人日 | 0.8 | 10人日 | 2025-08-08 |

### 読み取れること

- **開発フェーズ（id=8〜12）で遅延が発生**
  - 特に「開発 > 機能1」（id=9）のSPI=0.2が深刻
- **プロジェクト全体のSPI=0.779**だが、開発フェーズだけ見るとSPI=0.5
- **要員Aの負荷が高い**（8タスク、39人日）にもかかわらずSPI=0.789で遅れ気味
- **完了予測日が2025-10-06**で、終了予定日（2025-08-26）より**約6週間遅れ**
