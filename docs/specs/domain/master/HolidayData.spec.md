# HolidayData 仕様書

**バージョン**: 1.0.0
**作成日**: 2025-12-16
**ソースファイル**: `src/domain/HolidayData.ts`

---

## 1. 基本情報

### 1.1 概要

| 項目 | 内容 |
|------|------|
| **クラス名** | `HolidayData` |
| **分類** | **値オブジェクト（Value Object）** |
| **実装インターフェース** | - |
| **パッケージ** | `src/domain/HolidayData.ts` |
| **責務** | プロジェクトに定義された祝日情報を保持する。イミュータブルなデータ構造 |

### 1.2 ユビキタス言語（ドメイン用語）

| ドメイン用語 | 実装名 | 定義 |
|-------------|--------|------|
| 祝日 | `HolidayData` | プロジェクトで非稼働日として定義された日 |
| 祝日説明 | `_desc` | 祝日の名称（例：「元日」） |
| 祝日ルール | `_rule` | 祝日の定義ルール（例：「法律」） |
| 振替 | `_hurikae` | 振替元の祝日名 |

### 1.3 境界づけられたコンテキスト（所属ドメイン）

```
┌─────────────────────────────────────────────────────────────┐
│                      domain 層                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                   HolidayData                        │   │
│  │  - _date: Date                                      │   │
│  │  - _desc?: string                                   │   │
│  │  - _rule?: string                                   │   │
│  │  - _hurikae?: string                                │   │
│  └─────────────────────────────────────────────────────┘   │
│                          │                                  │
│                          │ aggregates                       │
│                          ▼                                  │
│                       Project                               │
└─────────────────────────────────────────────────────────────┘
```

---

## 2. 不変条件（Invariants）

| ID | 不変条件 | 検証タイミング |
|----|----------|----------------|
| INV-HD-01 | `_date`は常に存在する | 生成時 |
| INV-HD-02 | 全プロパティはreadonly（イミュータブル） | 常時 |

---

## 3. プロパティ仕様

### 3.1 コンストラクタ引数

| プロパティ | 型 | 必須 | 制約 | デフォルト | 説明 |
|-----------|-----|:----:|------|-----------|------|
| `_date` | `Date` | ○ | 有効な日付 | - | 祝日の日付 |
| `_desc` | `string` | - | - | `undefined` | 祝日の説明（例：「元日」） |
| `_rule` | `string` | - | - | `undefined` | 祝日定義ルール |
| `_hurikae` | `string` | - | - | `undefined` | 振替元の祝日 |

### 3.2 公開プロパティ（getter）

| プロパティ | 戻り型 | 説明 |
|-----------|--------|------|
| `date` | `Date` | 祝日の日付（readonly） |

### 3.3 内部キャッシュ

該当なし

---

## 4. コンストラクタ仕様

### 4.1 シグネチャ

```typescript
constructor(
    private readonly _date: Date,
    private readonly _desc?: string,
    private readonly _rule?: string,
    private readonly _hurikae?: string
)
```

### 4.2 事前条件（Preconditions）

| ID | 条件 | 違反時の動作 |
|----|------|-------------|
| PRE-C01 | `_date`がDateオブジェクトである | 不正なHolidayDataが生成される |

### 4.3 事後条件（Postconditions）

| ID | 条件 |
|----|------|
| POST-C01 | 全プロパティがreadonlyで設定される |
| POST-C02 | `date`getterで日付が取得可能 |

---

## 5. メソッド仕様

### 5.1 `get date(): Date`

#### 目的
祝日の日付を取得する

#### シグネチャ
```typescript
get date(): Date
```

#### 事前条件

該当なし

#### 事後条件

| ID | 条件 |
|----|------|
| POST-DATE-01 | コンストラクタで設定された`_date`を返す |

#### 同値クラス・境界値

| ID | 分類 | 入力条件 | 期待結果 |
|----|------|----------|----------|
| EQ-DATE-001 | 正常系 | 有効なHolidayData | 設定された日付が返される |

---

## 6. テストシナリオ（Given-When-Then形式）

### 6.1 コンストラクタ

```gherkin
Scenario: 祝日データを生成する
  Given 日付=2025-01-01, 説明="元日", ルール="法律"
  When  new HolidayData(date, "元日", "法律")を呼び出す
  Then  HolidayDataが生成される
  And   date getterで2025-01-01が取得できる

Scenario: 振替休日を生成する
  Given 日付=2025-01-02, 説明="振替休日", 振替="元日"
  When  new HolidayData(date, "振替休日", "", "元日")を呼び出す
  Then  HolidayDataが生成される

Scenario: 最小限の情報で生成する
  Given 日付=2025-01-01のみ
  When  new HolidayData(date)を呼び出す
  Then  HolidayDataが生成される
  And   _desc, _rule, _hurikaeはundefined
```

---

## 7. 外部依存

該当なし

---

## 8. 関連オブジェクト

### 8.1 依存関係図

```
┌─────────────────────────────────────────────────────────────┐
│                      HolidayData                            │
│  (値オブジェクト)                                           │
├─────────────────────────────────────────────────────────────┤
│                          │                                  │
│                          │ aggregates                       │
│                          ▼                                  │
│                       Project                               │
│                          │                                  │
│                          │ creates                          │
│                          ▼                                  │
│               MappingProjectCreator                         │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 関係一覧

| 関係先 | 関係タイプ | 説明 |
|--------|-----------|------|
| `Project` | aggregates | ProjectがHolidayData[]を保持 |
| `MappingProjectCreator` | creates | Excelから読み込んだデータから生成 |

---

## 9. テストケース数サマリ

| カテゴリ | 計画 | 実装 |
|----------|------|------|
| コンストラクタ | 3件 | 3件 |
| date getter | 1件 | 1件 |
| **合計** | **4件** | **4件** |

---

## 10. 要件トレーサビリティ

> **重要**: このセクションは必須です。grepで検索可能な形式で記載すること。

該当なし（基盤クラスのため特定の要件に紐づかない）

---

## 11. テスト実装

### 11.1 テストファイル

| ファイル | 説明 | テスト数 |
|---------|------|---------|
| `src/domain/__tests__/HolidayData.test.ts` | 単体テスト | 4件 |

### 11.2 テストフィクスチャ

該当なし

### 11.3 テスト実行結果

```
実行日: 2025-12-16
Test Suites: 1 passed, 1 total
Tests:       4 passed, 4 total
```

---

## 12. 設計上の課題・改善提案

| 課題 | 現状 | 改善案 |
|------|------|--------|
| getterの不足 | `_desc`, `_rule`, `_hurikae`のgetterが未実装 | 必要に応じて追加を検討 |

---

## 13. 変更履歴

| バージョン | 日付 | 変更内容 | 要件ID |
|-----------|------|---------|--------|
| 1.0.0 | 2025-12-16 | 初版作成 | - |
